<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tài khoản khách hàng</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Reset và font chữ */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
    background-color: #f5f5f5;
    color: #333;
    line-height: 1.6;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

/* Header */
.header {
    background-color: #2c3e50;
    color: white;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
}

.header h1 {
    font-size: 24px;
}

.user-nav {
    display: flex;
    gap: 15px;
}

.user-nav-link {
    color: white;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 5px;
    padding: 8px 12px;
    border-radius: 4px;
    transition: background-color 0.3s;
}

.user-nav-link:hover {
    background-color: #34495e;
}

.user-nav-link i {
    font-size: 16px;
}

/* Main content */
.main-content {
    background-color: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.content-section {
    display: none;
}

.content-section.active {
    display: block;
}

/* Profile form */
.profile-form {
    max-width: 600px;
    margin-top: 20px;
}

.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: 600;
}

.form-group input,
.form-group textarea,
.form-group select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 16px;
}

.form-group textarea {
    resize: vertical;
    min-height: 80px;
}

.form-actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
}

.btn {
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s;
}

.btn-primary {
    background-color: #3498db;
    color: white;
}

.btn-primary:hover {
    background-color: #2980b9;
}

.btn:disabled {
    background-color: #95a5a6;
    cursor: not-allowed;
}

/* Orders section */
.order-filter {
    margin: 20px 0;
}

.order-filter select {
    padding: 8px;
    border-radius: 4px;
    border: 1px solid #ddd;
}

.orders-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.order-card {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    transition: box-shadow 0.3s;
}

.order-card:hover {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.order-header {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
}

.order-id {
    font-weight: bold;
}

.order-date {
    color: #7f8c8d;
}

.order-status {
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 14px;
    font-weight: bold;
}

.status-pending {
    background-color: #f39c12;
    color: white;
}

.status-processing {
    background-color: #3498db;
    color: white;
}

.status-shipped {
    background-color: #9b59b6;
    color: white;
}

.status-delivered {
    background-color: #2ecc71;
    color: white;
}

.status-cancelled {
    background-color: #e74c3c;
    color: white;
}

.order-details {
    display: flex;
    gap: 15px;
    margin-bottom: 10px;
}

.order-items {
    flex: 2;
}

.order-item {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
}

.order-item:last-child {
    border-bottom: none;
    margin-bottom: 0;
    padding-bottom: 0;
}

.item-image {
    width: 60px;
    height: 60px;
    object-fit: cover;
    border-radius: 4px;
}

.item-info {
    flex: 1;
}

.item-name {
    font-weight: bold;
    margin-bottom: 5px;
}

.item-price {
    color: #e74c3c;
    font-weight: bold;
}

.order-summary {
    flex: 1;
    background-color: #f9f9f9;
    padding: 15px;
    border-radius: 8px;
}

.summary-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
}

.summary-total {
    font-weight: bold;
    font-size: 18px;
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid #ddd;
}

.order-actions {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
}

.action-btn {
    padding: 6px 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    background-color: white;
    cursor: pointer;
    transition: background-color 0.3s;
}

.action-btn:hover {
    background-color: #f5f5f5;
}

.action-btn.cancel {
    border-color: #e74c3c;
    color: #e74c3c;
}

.action-btn.view {
    border-color: #3498db;
    color: #3498db;
}

/* Footer */
.footer {
    text-align: center;
    margin-top: 20px;
    padding: 20px;
    color: #7f8c8d;
    font-size: 14px;
}

/* Responsive */
@media (max-width: 768px) {
    .header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
    }

    .user-nav {
        width: 100%;
        flex-direction: column;
        gap: 5px;
    }

    .order-details {
        flex-direction: column;
    }

    .form-actions {
        flex-direction: column;
    }

    .btn {
        width: 100%;
    }
}
    </style>
</head>
<body>
<div class="container">
    <header class="header">
        <h1>Tài khoản của tôi</h1>
        <nav class="user-nav">
            <a href="#" class="user-nav-link" onclick="showSection('profile')">
                <i class="fas fa-user"></i> Thông tin cá nhân
            </a>
            <a href="#" class="user-nav-link" onclick="showSection('orders')">
                <i class="fas fa-shopping-bag"></i> Đơn hàng của tôi
            </a>
            <a href="#" class="user-nav-link" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Đăng xuất
            </a>
        </nav>
    </header>

    <main class="main-content">
        <!-- Phần thông tin cá nhân -->
        <section id="profile-section" class="content-section active">
            <h2>Thông tin cá nhân</h2>
            <form id="profile-form" class="profile-form">
                <div class="form-group">
                    <label for="username">Tên người dùng</label>
                    <input type="text" id="username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="fullname">Họ và tên</label>
                    <input type="text" id="fullname" name="fullname" required>
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required readonly>
                </div>
                <div class="form-group">
                    <label for="phone">Số điện thoại</label>
                    <input type="tel" id="phone" name="phone" required>
                </div>
                <div class="form-group">
                    <label for="address">Địa chỉ</label>
                    <textarea id="address" name="address" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="birthday">Ngày sinh</label>
                    <input type="date" id="birthday" name="birthday">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn" onclick="enableEdit()">Chỉnh sửa</button>
                    <button type="submit" class="btn btn-primary" disabled>Lưu thay đổi</button>
                </div>
            </form>
        </section>

        <!-- Phần đơn hàng -->
        <section id="orders-section" class="content-section">
            <h2>Đơn hàng của tôi</h2>
            <div class="order-filter">
                <select id="order-status" onchange="filterOrders()">
                    <option value="all">Tất cả đơn hàng</option>
                    <option value="pending">Chờ xử lý</option>
                    <option value="processing">Đang xử lý</option>
                    <option value="shipped">Đang giao</option>
                    <option value="delivered">Đã giao</option>
                    <option value="cancelled">Đã hủy</option>
                </select>
            </div>
            <div class="orders-list" id="orders-list">
                <!-- Danh sách đơn hàng sẽ được thêm bằng JavaScript -->
            </div>
        </section>
    </main>

    <footer class="footer">
        <p>© 2023 Cửa hàng của chúng tôi. Tất cả quyền được bảo lưu.</p>
    </footer>
</div>

<script>
    // Dữ liệu mẫu - trong thực tế sẽ lấy từ API

async function fetchUserData() {
    try {
        // Gửi yêu cầu GET đến API
        const response = await fetch('http://localhost:8080/ShopNHN/api/users/1');

        // Kiểm tra nếu yêu cầu thành công
        if (!response.ok) {
            throw new Error('Không thể lấy dữ liệu sản phẩm');
        }

        // Chuyển dữ liệu JSON thành đối tượng
        const userData = await response.json();
        loadProfileData(userData)
    } catch (error) {
        console.error('Lỗi:', error);
    }
}




let ordersData = [
    {
        id: "DH20230001",
        date: "2023-05-15",
        status: "delivered",
        items: [
            { id: 1, name: "Áo thun nam trắng", price: 150000, quantity: 2, image: "https://via.placeholder.com/60" },
            { id: 2, name: "Quần jean nam đen", price: 350000, quantity: 1, image: "https://via.placeholder.com/60" }
        ],
        shippingFee: 30000
    },
    {
        id: "DH20230002",
        date: "2023-06-20",
        status: "shipped",
        items: [
            { id: 3, name: "Giày thể thao đen", price: 500000, quantity: 1, image: "https://via.placeholder.com/60" }
        ],
        shippingFee: 25000
    },
    {
        id: "DH20230003",
        date: "2023-07-01",
        status: "processing",
        items: [
            { id: 4, name: "Túi xách da", price: 450000, quantity: 1, image: "https://via.placeholder.com/60" },
            { id: 5, name: "Ví da nam", price: 200000, quantity: 1, image: "https://via.placeholder.com/60" }
        ],
        shippingFee: 20000
    },
    {
        id: "DH20230004",
        date: "2023-07-10",
        status: "pending",
        items: [
            { id: 6, name: "Mũ lưỡi trai", price: 120000, quantity: 3, image: "https://via.placeholder.com/60" }
        ],
        shippingFee: 15000
    },
    {
        id: "DH20230005",
        date: "2023-06-05",
        status: "cancelled",
        items: [
            { id: 7, name: "Áo khoác gió", price: 280000, quantity: 1, image: "https://via.placeholder.com/60" }
        ],
        shippingFee: 25000
    }
];

// Khởi tạo trang
document.addEventListener('DOMContentLoaded', function() {
    fetchUserData();
<!--    loadProfileData();-->
    loadOrders('all');
});

// Hiển thị section được chọn
function showSection(sectionId) {
    document.querySelectorAll('.content-section').forEach(section => {
        section.classList.remove('active');
    });

    document.getElementById(`${sectionId}-section`).classList.add('active');
}

// Đăng xuất
function logout() {
    alert('Bạn đã đăng xuất thành công!');
    // Trong thực tế sẽ chuyển hướng đến trang đăng nhập
    // window.location.href = '/login';
}

// ========== PHẦN THÔNG TIN CÁ NHÂN ==========

// Tải dữ liệu hồ sơ
function loadProfileData(userData) {
    document.getElementById('username').value = userData.username;
    document.getElementById('fullname').value = userData.fullName;
    document.getElementById('email').value = userData.email;
    document.getElementById('phone').value = userData.phone;
    document.getElementById('address').value = userData.address;
    document.getElementById('birthday').value = userData.dob;
}

// Bật chế độ chỉnh sửa
function enableEdit() {
    const inputs = document.querySelectorAll('#profile-form input:not([readonly]), #profile-form textarea');
    inputs.forEach(input => {
        input.removeAttribute('readonly');
        input.disabled = false;
    });

    document.querySelector('#profile-form button[type="submit"]').disabled = false;
}

// Xử lý submit form
document.getElementById('profile-form').addEventListener('submit', function(e) {
    e.preventDefault();

    // Lưu dữ liệu (trong thực tế sẽ gọi API)
    userData = {
        fullname: document.getElementById('fullname').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        address: document.getElementById('address').value,
        birthday: document.getElementById('birthday').value
    };

    alert('Thông tin đã được cập nhật thành công!');

    // Vô hiệu hóa các trường sau khi lưu
    const inputs = document.querySelectorAll('#profile-form input:not([readonly]), #profile-form textarea');
    inputs.forEach(input => {
        input.setAttribute('readonly', true);
        input.disabled = true;
    });

    document.querySelector('#profile-form button[type="submit"]').disabled = true;
});

// ========== PHẦN ĐƠN HÀNG ==========

// Tải danh sách đơn hàng
function loadOrders(status) {
    const ordersList = document.getElementById('orders-list');
    ordersList.innerHTML = '';

    let filteredOrders = ordersData;
    if (status !== 'all') {
        filteredOrders = ordersData.filter(order => order.status === status);
    }

    if (filteredOrders.length === 0) {
        ordersList.innerHTML = '<p>Không có đơn hàng nào.</p>';
        return;
    }

    filteredOrders.forEach(order => {
        const orderCard = document.createElement('div');
        orderCard.className = 'order-card';

        // Tính tổng tiền
        const subtotal = order.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
        const total = subtotal + order.shippingFee;

        // Tạo HTML cho đơn hàng
        orderCard.innerHTML = `
            <div class="order-header">
                <div>
                    <span class="order-id">Mã đơn hàng: ${order.id}</span>
                    <span class="order-date"> - ${formatDate(order.date)}</span>
                </div>
                <span class="order-status status-${order.status}">${getStatusText(order.status)}</span>
            </div>
            <div class="order-details">
                <div class="order-items">
                    ${order.items.map(item => `
                        <div class="order-item">
                            <img src="${item.image}" alt="${item.name}" class="item-image">
                            <div class="item-info">
                                <div class="item-name">${item.name}</div>
                                <div>${formatCurrency(item.price)} x ${item.quantity}</div>
                            </div>
                            <div class="item-price">${formatCurrency(item.price * item.quantity)}</div>
                        </div>
                    `).join('')}
                </div>
                <div class="order-summary">
                    <div class="summary-row">
                        <span>Tạm tính:</span>
                        <span>${formatCurrency(subtotal)}</span>
                    </div>
                    <div class="summary-row">
                        <span>Phí vận chuyển:</span>
                        <span>${formatCurrency(order.shippingFee)}</span>
                    </div>
                    <div class="summary-row summary-total">
                        <span>Tổng cộng:</span>
                        <span>${formatCurrency(total)}</span>
                    </div>
                </div>
            </div>
            <div class="order-actions">
                ${order.status === 'pending' ? '<button class="action-btn cancel" onclick="cancelOrder(\'${order.id}\')">Hủy đơn</button>' : ''}
                <button class="action-btn view" onclick="viewOrderDetail(\'${order.id}\')">Xem chi tiết</button>
            </div>
        `;

        ordersList.appendChild(orderCard);
    });
}

// Lọc đơn hàng theo trạng thái
function filterOrders() {
    const status = document.getElementById('order-status').value;
    loadOrders(status);
}

// Hủy đơn hàng
function cancelOrder(orderId) {
    if (confirm('Bạn có chắc chắn muốn hủy đơn hàng này?')) {
        // Trong thực tế sẽ gọi API để hủy đơn hàng
        const orderIndex = ordersData.findIndex(order => order.id === orderId);
        if (orderIndex !== -1) {
            ordersData[orderIndex].status = 'cancelled';
            loadOrders(document.getElementById('order-status').value);
            alert('Đã hủy đơn hàng thành công!');
        }
    }
}

// Xem chi tiết đơn hàng
function viewOrderDetail(orderId) {
    alert(`Xem chi tiết đơn hàng ${orderId}`);
    // Trong thực tế sẽ mở modal hoặc chuyển đến trang chi tiết
}

// ========== TIỆN ÍCH ==========

// Định dạng tiền tệ
function formatCurrency(amount) {
    return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount);
}

// Định dạng ngày
function formatDate(dateString) {
    const date = new Date(dateString);
    return date.toLocaleDateString('vi-VN');
}

// Lấy văn bản trạng thái
function getStatusText(status) {
    const statusMap = {
        'pending': 'Chờ xử lý',
        'processing': 'Đang xử lý',
        'shipped': 'Đang giao',
        'delivered': 'Đã giao',
        'cancelled': 'Đã hủy'
    };
    return statusMap[status] || status;
}
</script>
</body>
</html>